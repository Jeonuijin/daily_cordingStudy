-- CREATE TABLE

-- TABLE BOOK
CREATE TABLE BOOK 
(
  BOOK_ID NUMBER(3, 0) NOT NULL 
, BOOKNAME VARCHAR2(100 BYTE) NOT NULL 
, PRICE NUMBER(5, 0) NOT NULL 
, PUBLISHER VARCHAR2(50 BYTE) NOT NULL 
, PUB_DATE DATE NOT NULL 
, AUTHOR VARCHAR2(50 BYTE) NOT NULL 
, BOOK_CNT NUMBER(3, 0) 
, ORDER_CNT NUMBER(5, 0) 
, DETAILS VARCHAR2(300 BYTE) 
, BOOK_IMAGE VARCHAR2(300 BYTE) 
, CATEGORY VARCHAR2(30 BYTE) 
, REVIEW_ID NUMBER(3, 0) 
, STATUS VARCHAR2(3 BYTE) 
, CONSTRAINT SYS_C007286 PRIMARY KEY 
  (
    BOOK_ID 
  )
  USING INDEX 
  (
      CREATE UNIQUE INDEX SYS_C007286 ON BOOK (BOOK_ID ASC) 
      LOGGING 
      TABLESPACE SYSTEM 
      PCTFREE 10 
      INITRANS 2 
      STORAGE 
      ( 
        INITIAL 65536 
        NEXT 1048576 
        MINEXTENTS 1 
        MAXEXTENTS UNLIMITED 
        FREELISTS 1 
        FREELIST GROUPS 1 
        BUFFER_POOL DEFAULT 
      ) 
      NOPARALLEL 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

-- TABLE BOOK_REVIEW
CREATE TABLE BOOK_REVIEW 
(
  REVIEW_ID NUMBER(3, 0) NOT NULL 
, REVIEW_CONTENT VARCHAR2(300 BYTE) NOT NULL 
, GRADE NUMBER(2, 1) 
, BOOK_ID NUMBER(3, 0) 
, MEMBER_ID VARCHAR2(20 BYTE) NOT NULL 
, REGDATE DATE 
, CONSTRAINT SYS_C007290 PRIMARY KEY 
  (
    REVIEW_ID 
  )
  USING INDEX 
  (
      CREATE UNIQUE INDEX SYS_C007290 ON BOOK_REVIEW (REVIEW_ID ASC) 
      LOGGING 
      TABLESPACE SYSTEM 
      PCTFREE 10 
      INITRANS 2 
      STORAGE 
      ( 
        INITIAL 65536 
        NEXT 1048576 
        MINEXTENTS 1 
        MAXEXTENTS UNLIMITED 
        FREELISTS 1 
        FREELIST GROUPS 1 
        BUFFER_POOL DEFAULT 
      ) 
      NOPARALLEL 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

-- TABLE CART
CREATE TABLE CART 
(
  BOOK_CNT NUMBER(3, 0) 
, BOOK_ID NUMBER(5, 0) NOT NULL 
, MEM_ID VARCHAR2(20 BYTE) NOT NULL 
, PRICE NUMBER(10, 0) NOT NULL 
, BOOKNAME VARCHAR2(100 BYTE) NOT NULL 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

ALTER TABLE CART
ADD CONSTRAINT FK_CART_BOOK FOREIGN KEY
(
  BOOK_ID 
)
REFERENCES BOOK
(
  BOOK_ID 
)
ENABLE;

-- TABLE CATEGORY
CREATE TABLE CATEGORY 
(
  CATEGORY VARCHAR2(30 BYTE) NOT NULL 
, CONSTRAINT SYS_C007280 PRIMARY KEY 
  (
    CATEGORY 
  )
  USING INDEX 
  (
      CREATE UNIQUE INDEX SYS_C007280 ON CATEGORY (CATEGORY ASC) 
      LOGGING 
      TABLESPACE SYSTEM 
      PCTFREE 10 
      INITRANS 2 
      STORAGE 
      ( 
        INITIAL 65536 
        NEXT 1048576 
        MINEXTENTS 1 
        MAXEXTENTS UNLIMITED 
        FREELISTS 1 
        FREELIST GROUPS 1 
        BUFFER_POOL DEFAULT 
      ) 
      NOPARALLEL 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

-- TABLE DETAILS
CREATE TABLE DETAILS 
(
  DETAIL_NUM NUMBER(5, 0) NOT NULL 
, ORDER_ID NUMBER(5, 0) 
, MEM_ID VARCHAR2(20 BYTE) 
, BOOK_ID NUMBER(3, 0) 
, BOOKNAME VARCHAR2(100 BYTE) 
, BOOK_CNT NUMBER(3, 0) 
, PRICE NUMBER(10, 0) 
, CONSTRAINT DETAILS_PK PRIMARY KEY 
  (
    DETAIL_NUM 
  )
  USING INDEX 
  (
      CREATE UNIQUE INDEX DETAILS_PK ON DETAILS (DETAIL_NUM ASC) 
      LOGGING 
      TABLESPACE SYSTEM 
      PCTFREE 10 
      INITRANS 2 
      STORAGE 
      ( 
        INITIAL 65536 
        NEXT 1048576 
        MINEXTENTS 1 
        MAXEXTENTS UNLIMITED 
        FREELISTS 1 
        FREELIST GROUPS 1 
        BUFFER_POOL DEFAULT 
      ) 
      NOPARALLEL 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

-- TABLE LIKES
CREATE TABLE LIKES 
(
  BOOK_ID NUMBER(5, 0) NOT NULL 
, MEM_ID VARCHAR2(20 BYTE) 
, PRICE NUMBER(10, 0) 
, BOOKNAME VARCHAR2(100 BYTE) 
, BOOK_IMAGE VARCHAR2(300 BYTE) 
, CONSTRAINT LIKES_PK PRIMARY KEY 
  (
    BOOK_ID 
  )
  USING INDEX 
  (
      CREATE UNIQUE INDEX LIKES_PK ON LIKES (BOOK_ID ASC) 
      LOGGING 
      TABLESPACE SYSTEM 
      PCTFREE 10 
      INITRANS 2 
      STORAGE 
      ( 
        INITIAL 65536 
        NEXT 1048576 
        MINEXTENTS 1 
        MAXEXTENTS UNLIMITED 
        FREELISTS 1 
        FREELIST GROUPS 1 
        BUFFER_POOL DEFAULT 
      ) 
      NOPARALLEL 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

-- TABLE MEMBERS
CREATE TABLE MEMBERS 
(
  MEM_ID VARCHAR2(40 BYTE) NOT NULL 
, MEMPW VARCHAR2(20 BYTE) NOT NULL 
, NAME VARCHAR2(20 BYTE) NOT NULL 
, ADDRESS VARCHAR2(100 BYTE) NOT NULL 
, PHONE VARCHAR2(20 BYTE) NOT NULL 
, BIRTH VARCHAR2(8 BYTE) NOT NULL 
, EMAIL VARCHAR2(50 BYTE) NOT NULL 
, STATEMENT VARCHAR2(1 BYTE) 
, CONSTRAINT SYS_C007266 PRIMARY KEY 
  (
    MEM_ID 
  )
  USING INDEX 
  (
      CREATE UNIQUE INDEX SYS_C007266 ON MEMBERS (MEM_ID ASC) 
      LOGGING 
      TABLESPACE SYSTEM 
      PCTFREE 10 
      INITRANS 2 
      STORAGE 
      ( 
        INITIAL 65536 
        NEXT 1048576 
        MINEXTENTS 1 
        MAXEXTENTS UNLIMITED 
        FREELISTS 1 
        FREELIST GROUPS 1 
        BUFFER_POOL DEFAULT 
      ) 
      NOPARALLEL 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

-- TABLE NOTICEBOARD
CREATE TABLE NOTICEBOARD (
   NBIDX NUMBER NOT NULL,
   TYPE VARCHAR2(4000) NOT NULL, -- 이벤트, 배송 관련 등
   TITLE VARCHAR2(4000) NOT NULL,
   CONTENTS VARCHAR2(4000) NOT NULL,
   CREATEDAT DATE DEFAULT SYSDATE
);

-- TABLE ORDERS
CREATE TABLE ORDERS 
(
  ORDER_ID NUMBER(20, 0) NOT NULL 
, TOTAL_PRICE NUMBER(10, 0) 
, ORDERDATE DATE DEFAULT SYSDATE 
, DLVYDATE DATE DEFAULT SYSDATE+3 
, MEM_ID VARCHAR2(20 BYTE) 
, PAYMENT VARCHAR2(100 BYTE) 
, POINT NUMBER(10, 0) 
, CANCEL CHAR(1 BYTE) 
, TOTAL_CNT NUMBER(3, 0) 
, RCV_PHONE VARCHAR2(20 BYTE) 
, RCV_ADDRESS VARCHAR2(100 BYTE) 
, RCV_NAME VARCHAR2(20 BYTE) 
, CONSTRAINT ORDERS_PK PRIMARY KEY 
  (
    ORDER_ID 
  )
  USING INDEX 
  (
      CREATE UNIQUE INDEX ORDERS_PK ON ORDERS (ORDER_ID ASC) 
      LOGGING 
      TABLESPACE SYSTEM 
      PCTFREE 10 
      INITRANS 2 
      STORAGE 
      ( 
        INITIAL 65536 
        NEXT 1048576 
        MINEXTENTS 1 
        MAXEXTENTS UNLIMITED 
        FREELISTS 1 
        FREELIST GROUPS 1 
        BUFFER_POOL DEFAULT 
      ) 
      NOPARALLEL 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

-- TABLE QNABOARD
CREATE TABLE QNABOARD 
(
  Q_BOARD_ID NUMBER NOT NULL 
, MEM_ID VARCHAR2(40 BYTE) NOT NULL 
, Q_MEM_ID VARCHAR2(20 BYTE) NOT NULL 
, TITLE VARCHAR2(40 BYTE) NOT NULL 
, CONTENTS VARCHAR2(1000 BYTE) NOT NULL 
, BOARDPW NUMBER NOT NULL 
, ANSWER VARCHAR2(40 BYTE) NOT NULL 
, CREATEDAT DATE NOT NULL 
, IMAGE VARCHAR2(40 BYTE) 
, SECRET NUMBER 
, CONSTRAINT SYS_C007274 PRIMARY KEY 
  (
    Q_BOARD_ID 
  )
  USING INDEX 
  (
      CREATE UNIQUE INDEX SYS_C007274 ON QNABOARD (Q_BOARD_ID ASC) 
      LOGGING 
      TABLESPACE SYSTEM 
      PCTFREE 10 
      INITRANS 2 
      STORAGE 
      ( 
        INITIAL 65536 
        NEXT 1048576 
        MINEXTENTS 1 
        MAXEXTENTS UNLIMITED 
        FREELISTS 1 
        FREELIST GROUPS 1 
        BUFFER_POOL DEFAULT 
      ) 
      NOPARALLEL 
  )
  ENABLE 
) 
LOGGING 
TABLESPACE SYSTEM 
PCTFREE 10 
PCTUSED 40 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  FREELISTS 1 
  FREELIST GROUPS 1 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;



-- ALTER TABLE

-- TABLE BOOK
ALTER TABLE BOOK
ADD CONSTRAINT SYS_C007287 FOREIGN KEY
(
  CATEGORY 
)
REFERENCES CATEGORY
(
  CATEGORY 
)
ENABLE;

ALTER TABLE BOOK
ADD CONSTRAINT SYS_C007307 FOREIGN KEY
(
  REVIEW_ID 
)
REFERENCES BOOK_REVIEW
(
  REVIEW_ID 
)
ENABLE;

-- TABLE BOOK_REVIEW
ALTER TABLE BOOK_REVIEW
ADD CONSTRAINT FK_BOOK_REVIEW_BOOK FOREIGN KEY
(
  BOOK_ID 
)
REFERENCES BOOK
(
  BOOK_ID 
)
ENABLE;

ALTER TABLE BOOK_REVIEW
ADD CONSTRAINT FK_BOOK_REVIEW_MEMBER FOREIGN KEY
(
  MEMBER_ID 
)
REFERENCES MEMBERS
(
  MEM_ID 
)
ON DELETE CASCADE ENABLE;

-- TABLE CART
ALTER TABLE CART
ADD CONSTRAINT FK_CART_MEMBER FOREIGN KEY
(
  MEM_ID 
)
REFERENCES MEMBERS
(
  MEM_ID 
)
ENABLE;

-- TABLE DETAILS
ALTER TABLE DETAILS
ADD CONSTRAINT DETAILS_FK1 FOREIGN KEY
(
  ORDER_ID 
)
REFERENCES ORDERS
(
  ORDER_ID 
)
ON DELETE CASCADE ENABLE;

-- TABLE LIKES
ALTER TABLE LIKES
ADD CONSTRAINT LIKES_FK1 FOREIGN KEY
(
  BOOK_ID 
)
REFERENCES BOOK
(
  BOOK_ID 
)
ENABLE;

-- TABLE ORDERS
ALTER TABLE ORDERS
ADD CONSTRAINT FK_ORDERS_MEMBER FOREIGN KEY
(
  MEM_ID 
)
REFERENCES MEMBERS
(
  MEM_ID 
)
DISABLE;

-- TABLE QNABOARD
ALTER TABLE QNABOARD
ADD CONSTRAINT QNABOARD_MEM_ID_FK FOREIGN KEY
(
  MEM_ID 
)
REFERENCES MEMBERS
(
  MEM_ID 
)
ON DELETE CASCADE ENABLE;



-- CREATE SEQUENCE
CREATE SEQUENCE BOOKID_SEQ INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE;

CREATE SEQUENCE DETAIL_NUM_SEQ INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE;

CREATE SEQUENCE NOTICEBOARD_SEQ INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE;

CREATE SEQUENCE ORDER_ID_SEQ INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE;

CREATE SEQUENCE QNABOARD_SEQ INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE;

CREATE SEQUENCE REVIEW_ID_SEQ INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE;